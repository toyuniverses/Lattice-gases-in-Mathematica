(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26233,        652]
NotebookOptionsPosition[     24870,        602]
NotebookOutlinePosition[     25229,        618]
CellTagsIndexPosition[     25186,        615]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
LGA Kernel simulation Example: RSS lattice gas
(from paper, \[OpenCurlyDoubleQuote]Ideal energy of classical lattice \
dynamics\[CloseCurlyDoubleQuote])\
\>", "Section",
 CellChangeTimes->{{3.676746166253903*^9, 3.676746187506474*^9}, {
  3.6767462868236637`*^9, 3.6767463245206747`*^9}, {3.67674637488876*^9, 
  3.67674641284793*^9}}],

Cell[TextData[{
 StyleBox["This model is rotationally symmetric, but we only simulate \
collisions along one axis here, for simplicity.  Thus we only need to include \
bit planes traveling south-east and north-east, and compute a lookup table \
for particles that collide while moving eastward. ",
  FontColor->GrayLevel[0.5]],
 StyleBox[" ",
  FontColor->RGBColor[0, 0, 1]]
}], "Text",
 CellChangeTimes->{{3.676083382742638*^9, 3.676083471685182*^9}, {
  3.67608355045831*^9, 3.676083559601769*^9}, {3.6760852524103117`*^9, 
  3.676085262644082*^9}, {3.67608531171168*^9, 3.676085349714819*^9}, {
  3.6767464662749643`*^9, 3.6767464745544777`*^9}}],

Cell[BoxData[
 RowBox[{"Lattice", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"X", "=", "256"}], ",", 
     RowBox[{"Y", "=", "256"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"southEast", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"northEast", ",", "2"}], "}"}], ",", " ", "displayRed", ",", 
     "displayGreen", ",", "displayBlue"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.676046720620493*^9, 3.67604673238124*^9}, {
   3.676046775174062*^9, 3.676046780459873*^9}, {3.6760478943256598`*^9, 
   3.676047907896397*^9}, {3.67604810842029*^9, 3.676048111529024*^9}, {
   3.676049682375222*^9, 3.676049695298191*^9}, 3.676049739941059*^9, {
   3.6760515997013607`*^9, 3.676051605327366*^9}, 3.676051647385582*^9, {
   3.67607805364576*^9, 3.676078058509933*^9}, {3.676078573036642*^9, 
   3.676078577572246*^9}, {3.676079266496808*^9, 3.676079271108377*^9}, {
   3.6760825529990177`*^9, 3.67608255942929*^9}, {3.676082647050557*^9, 
   3.676082652646634*^9}, {3.676082685602488*^9, 3.676082726314816*^9}, {
   3.676083086811039*^9, 3.6760830924015102`*^9}, {3.676693737908662*^9, 
   3.6766939289973993`*^9}, 3.6766957530359507`*^9, {3.676697517590695*^9, 
   3.676697522901821*^9}, {3.676726293714302*^9, 3.676726297260734*^9}, {
   3.676744863213673*^9, 3.676744867402865*^9}, {3.6767456128623753`*^9, 
   3.676745618297976*^9}, {3.677073318301758*^9, 3.677073319673571*^9}, {
   3.677073422995348*^9, 3.677073430617243*^9}, {3.6770739548139973`*^9, 
   3.677073955481941*^9}, {3.677726083909294*^9, 3.67772608568067*^9}, {
   3.6777261159869833`*^9, 3.677726117223132*^9}, {3.677795984616809*^9, 
   3.677795985468266*^9}, {3.677796024775172*^9, 3.6777960254428263`*^9}}],

Cell[TextData[StyleBox["The rule is given in figure 1c of the paper as a \
block partitioning rule, with four kinds of particle states (empty, black, \
plus, and minus). The block dynamics is equivalent to a lattice gas rule if \
we imagine the blocks capture the positions of continuously moving particles \
a half step before and after they come together at lattice sites.",
 FontColor->GrayLevel[0.5]]], "Text",
 CellChangeTimes->{{3.676083581140379*^9, 3.676083621923568*^9}, {
   3.676083663442503*^9, 3.676083689989943*^9}, {3.676083728127718*^9, 
   3.67608377191644*^9}, {3.676084161475087*^9, 3.676084163422773*^9}, {
   3.6760853698907223`*^9, 3.676085473554748*^9}, {3.676085516756886*^9, 
   3.676085640462731*^9}, {3.6760862554026833`*^9, 3.676086268573904*^9}, 
   3.676694124889428*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"none", "=", "0"}], ";", " ", 
   RowBox[{"black", "=", "1"}], ";", 
   RowBox[{"plus", "=", "2"}], ";", 
   RowBox[{"minus", "=", "3"}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.676746826626333*^9, 3.676746851756184*^9}, 
   3.6767468864930143`*^9, {3.676746974835834*^9, 3.676746978625819*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rssLUT", "=", 
  RowBox[{"LUT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"southEast", ",", "northEast"}], "}"}], ",", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"southEast", "\[Equal]", "none"}], "   ", "&&", " ", 
       RowBox[{"northEast", "\[Equal]", "plus"}]}], ",", "  ", 
      RowBox[{"{", 
       RowBox[{"plus", ",", "    ", "none"}], "}"}], ",", "   ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"southEast", "\[Equal]", "minus"}], " ", "&&", " ", 
       RowBox[{"northEast", "\[Equal]", "none"}]}], ",", "  ", 
      RowBox[{"{", 
       RowBox[{"none", ",", "  ", "minus"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"southEast", "\[Equal]", "black"}], " ", "&&", " ", 
       RowBox[{"northEast", "\[Equal]", "black"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"minus", ",", "  ", "plus"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"southEast", "\[Equal]", "minus"}], " ", "&&", " ", 
       RowBox[{"northEast", "\[Equal]", "plus"}]}], ",", "   ", 
      RowBox[{"{", 
       RowBox[{"plus", ",", "  ", "minus"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"southEast", "\[Equal]", "plus"}], "   ", "&&", " ", 
       RowBox[{"northEast", "\[Equal]", " ", "minus"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"black", ",", "black"}], "}"}], ",", "    ", "True", ",", 
      RowBox[{"{", 
       RowBox[{"southEast", ",", "northEast"}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6760429981565847`*^9, 3.6760431556659822`*^9}, {
   3.676044775770585*^9, 3.676044788325863*^9}, {3.676044852611561*^9, 
   3.676044861531767*^9}, 3.676047709767625*^9, {3.6760528080338078`*^9, 
   3.6760528102607927`*^9}, {3.6760687846337337`*^9, 3.676068785119114*^9}, {
   3.6760691839225063`*^9, 3.6760691900059566`*^9}, {3.676069222889659*^9, 
   3.676069229807105*^9}, 3.676069318948591*^9, 3.6760694208309593`*^9, {
   3.6760694525007563`*^9, 3.6760694714040213`*^9}, {3.6760695134816628`*^9, 
   3.67606956502115*^9}, 3.676069615251525*^9, {3.676069747996851*^9, 
   3.676069784432425*^9}, {3.676069829945231*^9, 3.676069887158832*^9}, {
   3.6760699985400763`*^9, 3.676070027190905*^9}, {3.676070066707347*^9, 
   3.676070072576058*^9}, {3.6760701307659817`*^9, 3.676070180882122*^9}, {
   3.676070227248538*^9, 3.676070229868134*^9}, {3.6760703258954487`*^9, 
   3.676070392575395*^9}, {3.676070423294737*^9, 3.676070429925296*^9}, {
   3.676070566117668*^9, 3.6760705821910048`*^9}, {3.676070632283688*^9, 
   3.676070690132567*^9}, {3.6760707346710787`*^9, 3.676070803090913*^9}, {
   3.6760709030757227`*^9, 3.6760709846601887`*^9}, 3.6760710250751762`*^9, {
   3.6760711108816423`*^9, 3.676071124919938*^9}, {3.676071160739067*^9, 
   3.676071164378007*^9}, {3.676071228157159*^9, 3.676071310689637*^9}, {
   3.676071355954598*^9, 3.6760714063872023`*^9}, {3.6760714903719254`*^9, 
   3.67607162242216*^9}, {3.676071660749731*^9, 3.676071672534789*^9}, {
   3.6760717385972652`*^9, 3.676071766239708*^9}, {3.6760718075343313`*^9, 
   3.676071816494034*^9}, {3.6760718966253777`*^9, 3.6760719301754007`*^9}, {
   3.676071987862441*^9, 3.676072020764154*^9}, {3.676072056982729*^9, 
   3.676072074651946*^9}, 3.676072120163499*^9, {3.6760721555018578`*^9, 
   3.67607224334373*^9}, {3.676072292530593*^9, 3.676072300653386*^9}, 
   3.676072397404882*^9, {3.6760727160344048`*^9, 3.67607277495857*^9}, {
   3.676072838344648*^9, 3.676073077967908*^9}, {3.6760731168069983`*^9, 
   3.676073257622487*^9}, {3.676073292857078*^9, 3.67607330423785*^9}, {
   3.6760733369558287`*^9, 3.6760733530047197`*^9}, {3.676073404755509*^9, 
   3.6760734911691027`*^9}, {3.676073521624702*^9, 3.676073601829397*^9}, {
   3.676073636711267*^9, 3.676073641607437*^9}, {3.6760737333681498`*^9, 
   3.676073751518235*^9}, {3.676073823307403*^9, 3.676073836675207*^9}, {
   3.676073937895029*^9, 3.676073950246011*^9}, {3.676074196083309*^9, 
   3.676074197712696*^9}, {3.6760742444618*^9, 3.676074257760066*^9}, {
   3.6760744191840067`*^9, 3.6760744350827847`*^9}, {3.676074477523864*^9, 
   3.676074487954082*^9}, {3.676074556067004*^9, 3.6760745681445007`*^9}, {
   3.6760761710791388`*^9, 3.6760762068518887`*^9}, {3.676076460589596*^9, 
   3.676076504797057*^9}, {3.676076596619217*^9, 3.676076661873438*^9}, {
   3.676076702780458*^9, 3.6760767917187157`*^9}, {3.676076824285994*^9, 
   3.6760768403734217`*^9}, {3.676076885524231*^9, 3.676076900092011*^9}, 
   3.6760783662093887`*^9, {3.676081378464425*^9, 3.67608164771944*^9}, {
   3.676083494647572*^9, 3.676083532365881*^9}, {3.6766939726819563`*^9, 
   3.676693994335713*^9}, {3.676694035128989*^9, 3.676694074482502*^9}, {
   3.676694399605118*^9, 3.676694399623836*^9}, {3.6766947189863234`*^9, 
   3.67669472997766*^9}, 3.6766957658329687`*^9, {3.67669749154317*^9, 
   3.676697498958988*^9}, {3.6766998534591312`*^9, 3.676699879790247*^9}, {
   3.676746536328979*^9, 3.676746546310432*^9}, {3.676746827670101*^9, 
   3.6767468574322987`*^9}, {3.676746887572255*^9, 3.6767468923229933`*^9}, {
   3.676746941454413*^9, 3.676747081189234*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.676746547282434*^9, 3.676747155609412*^9, 
  3.676748538020718*^9, 3.676760379618537*^9, 3.677072277252248*^9, 
  3.6770732816139708`*^9, 3.677073325062282*^9, 3.677073404409644*^9, 
  3.677073436324333*^9, 3.677073959328673*^9, 3.677263046522784*^9, 
  3.677282584107868*^9, 3.6772837517303762`*^9, 3.677413537382658*^9, 
  3.6774373957791357`*^9, 3.677437584539805*^9, 3.677505298524021*^9, 
  3.677610836545429*^9, 3.677611016320978*^9, 3.677726090974361*^9, 
  3.67779589501785*^9, 3.677795997908229*^9, 3.677796029643092*^9, 
  3.6779440765032587`*^9, 3.706671844708577*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"displayLUT", "=", 
  RowBox[{"LUT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"southEast", ",", "northEast"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"southEast", "\[Equal]", "black"}], " ", "\[Or]", " ", 
         RowBox[{"northEast", " ", "\[Equal]", " ", "black"}]}], ",", "1", 
        ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"southEast", "\[Equal]", "plus"}], "   ", "\[Or]", " ", 
         RowBox[{"northEast", " ", "\[Equal]", " ", "plus"}]}], ",", "   ", 
        "1", ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"southEast", "\[Equal]", " ", "minus"}], "\[Or]", " ", 
         RowBox[{"northEast", " ", "\[Equal]", " ", "minus"}]}], ",", "1", 
        ",", "0"}], "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6767478094823112`*^9, 3.676748028529407*^9}, {
  3.676748069968541*^9, 3.676748075446805*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.676748029835559*^9, 3.676748538167593*^9, 
  3.676760379814753*^9, 3.6770722773439627`*^9, 3.677073281775886*^9, 
  3.677073325206485*^9, 3.677073404515808*^9, 3.677073436517872*^9, 
  3.677073959511896*^9, 3.677263046610195*^9, 3.6772825842396517`*^9, 
  3.677283751832973*^9, 3.677413537487859*^9, 3.677437395863529*^9, 
  3.677437584637835*^9, 3.677505298612671*^9, 3.677610836642333*^9, 
  3.677611016430414*^9, 3.6777260910667057`*^9, 3.6777958951273413`*^9, 
  3.6777959980184097`*^9, 3.677796029746014*^9, 3.677944076619849*^9, 
  3.706671844820313*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"identityLUT", "=", 
   RowBox[{"LUT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"southEast", ",", "northEast"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"southEast", ",", "northEast"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.676694914055296*^9, 3.67669496837267*^9}, {
   3.676697565161819*^9, 3.676697583900181*^9}, 3.6767481802132797`*^9, {
   3.677610945992383*^9, 3.677610958048442*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"kicks", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"+", "1"}], ",", 
       RowBox[{"+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"+", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676694171900175*^9, 3.6766942061746264`*^9}, {
   3.676745066874586*^9, 3.676745083609714*^9}, {3.676745179340034*^9, 
   3.67674518311621*^9}, {3.676745844198563*^9, 3.67674584920144*^9}, 
   3.67674818679671*^9, 3.6777030660032*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rssStep", "=", 
  RowBox[{"Step", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"southEast", ",", "northEast"}], "}"}], ",", "kicks", ",", 
    RowBox[{"{", 
     RowBox[{"rssLUT", ",", "displayLUT"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "southEast", ",", "northEast", ",", "displayRed", ",", "displayGreen", 
      ",", "displayBlue"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.676694221208354*^9, 3.676694264706873*^9}, {
   3.676694436066394*^9, 3.676694443142165*^9}, {3.6766948242437983`*^9, 
   3.67669486353065*^9}, {3.676697592686391*^9, 3.6766976082116737`*^9}, 
   3.677437469106922*^9, 3.677437542419342*^9, 3.67761096621241*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.677610967292509*^9, 3.6776110165568333`*^9, 
  3.677726091179225*^9, 3.677795895249235*^9, 3.6777959981564903`*^9, 
  3.677796029875616*^9, 3.67794407675016*^9, 3.706671844956501*^9}]
}, Open  ]],

Cell[TextData[StyleBox["We put an initial block pattern into the center of \
the space, and then shift it to get the initial state.",
 FontColor->GrayLevel[0.5]]], "Text",
 CellChangeTimes->{{3.676083914248774*^9, 3.676083962168572*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"blockPat", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "\[GreaterEqual]", 
         RowBox[{"3", " ", 
          RowBox[{"X", "/", "8"}]}]}], " ", "&&", " ", 
        RowBox[{"x", "<", 
         RowBox[{"5", 
          RowBox[{"X", "/", "8"}]}]}], " ", "&&", " ", 
        RowBox[{"y", "\[GreaterEqual]", 
         RowBox[{"3", " ", 
          RowBox[{"Y", "/", "8"}]}]}], " ", "&&", " ", 
        RowBox[{"y", "<", 
         RowBox[{"5", 
          RowBox[{"Y", "/", "8"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"black", ",", "black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", 
       RowBox[{"Y", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"X", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6760517093867702`*^9, 3.676051722236189*^9}, 
   3.67605177139434*^9, {3.6760522667279*^9, 3.676052309637545*^9}, {
   3.676052535218696*^9, 3.676052539796286*^9}, {3.676077034382248*^9, 
   3.676077042713421*^9}, {3.676077092582697*^9, 3.67607711197139*^9}, {
   3.676077887107312*^9, 3.676077924252358*^9}, {3.6760779959655733`*^9, 
   3.6760780242374277`*^9}, {3.6766950372308683`*^9, 
   3.6766950958011227`*^9}, {3.6766951393025627`*^9, 3.676695163819672*^9}, {
   3.676725824419899*^9, 3.676725832746914*^9}, 3.676726337222197*^9, 
   3.676744578781857*^9, {3.676746832701455*^9, 3.6767468333592787`*^9}, {
   3.677073718565022*^9, 3.6770737408246737`*^9}, {3.677073790510603*^9, 
   3.6770737958945007`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteFields", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"southEast", ",", "northEast"}], "}"}], ",", "blockPat"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"UpdateLattice", "[", 
  RowBox[{"Step", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"southEast", ",", "northEast"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], 
         RowBox[{"X", "/", "8"}]}], ",", 
        RowBox[{
         RowBox[{"-", "Y"}], "/", "4"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], 
         RowBox[{"X", "/", "8"}]}], ",", 
        RowBox[{
         RowBox[{"+", "Y"}], "/", "4"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"identityLUT", ",", "displayLUT"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "southEast", ",", "northEast", ",", "displayRed", ",", "displayGreen", 
      ",", "displayBlue"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.67669520959394*^9, 3.676695258550392*^9}, {
   3.67669533231848*^9, 3.676695420745818*^9}, 3.676695571632346*^9, {
   3.6766957895295353`*^9, 3.676695826250716*^9}, {3.676697810862854*^9, 
   3.676697818607972*^9}, {3.676697930364812*^9, 3.676697934461433*^9}, {
   3.676698296711844*^9, 3.67669833862258*^9}, {3.676700166144947*^9, 
   3.676700215517735*^9}, {3.67674217799829*^9, 3.676742191001568*^9}, 
   3.6767422290376387`*^9, {3.676744805100491*^9, 3.676744812383298*^9}, {
   3.67674581510981*^9, 3.676745821899756*^9}, {3.677437296171855*^9, 
   3.677437306721712*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rssImage", "=", 
   RowBox[{"Image", "[", 
    RowBox[{"ReadFields", "[", 
     RowBox[{"{", 
      RowBox[{"displayRed", ",", "displayGreen", ",", "displayBlue"}], "}"}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", "rssImage", "]"}]}], "Input",
 CellChangeTimes->{{3.6767448326324253`*^9, 3.676744849383366*^9}, 
   3.676744954117176*^9, 3.676745269263216*^9, {3.677283414413074*^9, 
   3.677283437315132*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`rssImage, StandardForm],
  ImageSizeCache->{256., {126., 130.}}]], "Output",
 CellChangeTimes->{3.6772837555906267`*^9, 3.677413541205041*^9, 
  3.677437399536037*^9, 3.6774375883211317`*^9, 3.677505302360889*^9, 
  3.6776108404033318`*^9, 3.677611020212784*^9, 3.677726093242303*^9, 
  3.6777958989905233`*^9, 3.677795998881722*^9, 3.6777960335375233`*^9, 
  3.677944077867034*^9, 3.7066718452703743`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"run", "=", "True"}], ";", 
  RowBox[{"Dynamic", "[", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Stop\>\"", ",", 
     RowBox[{"run", "=", "False"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{"run", ",", " ", 
   RowBox[{"rssImage", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"UpdateLattice", "[", "rssStep", "]"}], ";", 
      RowBox[{"Image", "[", 
       RowBox[{
        RowBox[{"ReadFields", "[", 
         RowBox[{"{", 
          RowBox[{"displayRed", ",", "displayGreen", ",", "displayBlue"}], 
          "}"}], "]"}], ",", "\"\<Bit\>\""}], "]"}]}], ")"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.67727987048532*^9, 3.677279898517233*^9}, {
   3.677279929075202*^9, 3.677279936047266*^9}, {3.677280078811948*^9, 
   3.677280146205212*^9}, {3.6772801811680803`*^9, 3.677280184192918*^9}, {
   3.6772802414180107`*^9, 3.6772802581152897`*^9}, {3.67728096772622*^9, 
   3.677280976670618*^9}, {3.677281288575551*^9, 3.677281317632428*^9}, {
   3.677281499493561*^9, 3.67728150277872*^9}, {3.67728153717269*^9, 
   3.6772815504234743`*^9}, 3.677281587461059*^9, {3.6772825300425*^9, 
   3.677282551677032*^9}, {3.6774373760744057`*^9, 3.677437383494959*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   Button["Stop", $CellContext`run = False], StandardForm],
  ImageSizeCache->{70., {8.3, 17.7}}]], "Output",
 CellChangeTimes->{
  3.677280147671335*^9, 3.6772801935735283`*^9, {3.677280272803691*^9, 
   3.6772802861505833`*^9}, 3.677280332636683*^9, 3.677281002720707*^9, 
   3.67728135660605*^9, 3.6772814354773006`*^9, 3.677281619167165*^9, 
   3.677282588318479*^9, 3.677283755676107*^9, 3.6774135413217773`*^9, 
   3.677437399638987*^9, 3.677437588444219*^9, 3.677505302449112*^9, 
   3.67761084053176*^9, 3.677611020300404*^9, 3.6777260933685703`*^9, 
   3.677795899108873*^9, 3.677795998992566*^9, 3.677796033649961*^9, 
   3.6779440779957542`*^9, 3.706671845361945*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"5", "/", 
  RowBox[{
   RowBox[{"Timing", "[", 
    RowBox[{"UpdateLattice", "[", 
     RowBox[{"rssStep", ",", "5"}], "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.677505348837357*^9, 3.677505373380674*^9}, {
  3.6779440521124268`*^9, 3.677944071811801*^9}}],

Cell[BoxData["29.55746562466748`"], "Output",
 CellChangeTimes->{3.677505393308378*^9, 3.677610891567876*^9, 
  3.677611070417645*^9, 3.677726116309497*^9, 3.677795951140148*^9, 
  3.6777960221700163`*^9, 3.677796061726122*^9, 3.6779441186088657`*^9, 
  3.706671909896385*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["To animate, save a ",
  FontColor->GrayLevel[0.5]],
 StyleBox["Table",
  FontWeight->"Bold",
  FontColor->GrayLevel[0.5]],
 StyleBox[" of images to ",
  FontColor->GrayLevel[0.5]],
 StyleBox["imageList ",
  FontWeight->"Bold",
  FontColor->GrayLevel[0.5]],
 StyleBox["and use ",
  FontColor->GrayLevel[0.5]],
 StyleBox["ListAnimate[imageList]",
  FontWeight->"Bold",
  FontColor->GrayLevel[0.5]],
 StyleBox[".  To export a movie, use ",
  FontColor->GrayLevel[0.5]],
 StyleBox["Export[\[OpenCurlyDoubleQuote]directory/name.mov\
\[CloseCurlyDoubleQuote],imageList]",
  FontWeight->"Bold",
  FontColor->GrayLevel[0.5]]
}], "Text",
 CellChangeTimes->{{3.67770333925939*^9, 3.677703369205873*^9}, {
  3.677703403048716*^9, 3.67770342009582*^9}, {3.6777034911035633`*^9, 
  3.677703507720806*^9}}]
}, Open  ]]
},
WindowSize->{873, 840},
WindowMargins->{{170, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 345, 7, 99, "Section"],
Cell[928, 31, 649, 12, 68, "Text"],
Cell[1580, 45, 1749, 31, 32, "Input"],
Cell[3332, 78, 801, 11, 68, "Text"],
Cell[4136, 91, 347, 8, 32, "Input"],
Cell[CellGroupData[{
Cell[4508, 103, 5212, 88, 138, "Input"],
Cell[9723, 193, 1598, 43, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11358, 241, 1131, 28, 96, "Input"],
Cell[12492, 271, 1739, 43, 54, "Output"]
}, Open  ]],
Cell[14246, 317, 463, 12, 32, "Input"],
Cell[14712, 331, 575, 16, 32, "Input"],
Cell[CellGroupData[{
Cell[15312, 351, 690, 15, 54, "Input"],
Cell[16005, 368, 798, 22, 32, "Output"]
}, Open  ]],
Cell[16818, 393, 237, 3, 30, "Text"],
Cell[17058, 398, 1722, 40, 54, "Input"],
Cell[18783, 440, 1632, 42, 75, "Input"],
Cell[CellGroupData[{
Cell[20440, 486, 481, 11, 54, "Input"],
Cell[20924, 499, 453, 7, 271, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21414, 511, 1248, 27, 75, "Input"],
Cell[22665, 540, 713, 12, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23415, 557, 326, 8, 32, "Input"],
Cell[23744, 567, 276, 4, 32, "Output"]
}, Open  ]],
Cell[24035, 574, 819, 25, 49, "Text"]
}, Open  ]]
}
]
*)

