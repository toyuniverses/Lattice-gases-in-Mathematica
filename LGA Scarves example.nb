(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27957,        604]
NotebookOptionsPosition[     26810,        563]
NotebookOutlinePosition[     27170,        579]
CellTagsIndexPosition[     27127,        576]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Charlie Bennett\[CloseCurlyQuote]s 1D reversible \
\[OpenCurlyDoubleQuote]Scarves\[CloseCurlyDoubleQuote] rule
(implemented with a second dimension for seeing history)\
\>", "Section",
 CellChangeTimes->{{3.677707349638533*^9, 3.677707416410501*^9}}],

Cell[TextData[StyleBox["Charlie Bennett constructed this rule for Stephen \
Wolfram one day in the 1980\[CloseCurlyQuote]s, after Stephen made the \
comment that there were no interesting reversible rules in 1D.  This is a \
variant of the Creutz reversible Ising dynamics, which uses the four nearest \
neighbors in 2D, flipping the center in the past to get the future if half of \
the neighbors are one.  This uses the same rule with the four nearest \
neighbors in 1D.\n\nTo implement this as a lattice gas, we make copies of the \
new center value, so we can send a copy to each of the neighbors.  Logically, \
though, there are only two distinct bits per cell.  To show history \
vertically scrolling, we also make copies of the two cell bits to send \
downward.",
 FontColor->GrayLevel[0.5]]], "Text",
 CellChangeTimes->{{3.676927356727128*^9, 3.676927402451315*^9}, {
  3.6769275655289*^9, 3.676927636735063*^9}, {3.676927731020523*^9, 
  3.676927768594542*^9}, {3.676927924378499*^9, 3.6769279280630293`*^9}, {
  3.676927977693533*^9, 3.676927983752067*^9}, {3.677545326770607*^9, 
  3.677545426087083*^9}, {3.6775455024133883`*^9, 3.677545556974162*^9}, {
  3.677549772375958*^9, 3.677549776857553*^9}, {3.677559100394809*^9, 
  3.677559100606324*^9}, {3.677678616036998*^9, 3.6776787759543343`*^9}, {
  3.677707668022653*^9, 3.677707808404689*^9}, {3.6777093551758213`*^9, 
  3.677709475666594*^9}, {3.6777121995356197`*^9, 3.677712225694784*^9}}],

Cell[BoxData[
 RowBox[{"Lattice", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"X", "=", "256"}], ",", 
     RowBox[{"Y", "=", "64"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "center", ",", "east", ",", "eastEast", ",", "west", ",", "westWest", ",",
      "north", ",", "oldCenter", ",", " ", "oldNorth", ",", "top"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.67770741978405*^9, 3.6777074498633327`*^9}, {
   3.677707491991783*^9, 3.6777075873667927`*^9}, {3.677708006640059*^9, 
   3.6777080243365*^9}, {3.6777084441629133`*^9, 3.677708453027219*^9}, {
   3.6777085052073307`*^9, 3.6777085250651083`*^9}, 3.677708641884714*^9, {
   3.677711729185279*^9, 3.677711732540511*^9}, {3.677712021519801*^9, 
   3.677712028531184*^9}, {3.677712140312192*^9, 3.677712145443853*^9}, {
   3.6777214676975603`*^9, 3.677721467956435*^9}, {3.677722582427588*^9, 
   3.677722587953055*^9}, {3.677722670493762*^9, 3.677722670873925*^9}, {
   3.6777230415937157`*^9, 3.677723041956791*^9}, {3.6777230936236067`*^9, 
   3.677723094770033*^9}, {3.677723202803795*^9, 3.677723203742835*^9}, {
   3.677723282359845*^9, 3.677723323241653*^9}, {3.677724116426854*^9, 
   3.677724122111648*^9}, {3.677724168255871*^9, 3.677724170387895*^9}, {
   3.677724222989276*^9, 3.677724229152628*^9}, {3.677724363906876*^9, 
   3.677724364254771*^9}, {3.677724452220377*^9, 3.6777244600791616`*^9}, {
   3.677724522098466*^9, 3.677724543996512*^9}, {3.677724595044634*^9, 
   3.677724601497148*^9}, {3.677724950981881*^9, 3.6777249524012623`*^9}, {
   3.67777606101658*^9, 3.67777606184416*^9}, {3.677776188069438*^9, 
   3.6777761884570312`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"scarvesLUT", "=", 
   RowBox[{"LUT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "center", ",", "east", ",", "eastEast", ",", "west", ",", "westWest", 
       ",", " ", "north", ",", "oldCenter", ",", "oldNorth", ",", "top"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"new", ",", "old"}], "}"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"top", "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"north", ",", "oldNorth"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "east", " ", "+", " ", "eastEast", " ", "+", "west", " ", "+", 
               " ", "westWest"}], "\[Equal]", " ", "2"}], ",", 
             RowBox[{"1", " ", "-", "oldCenter"}], ",", "oldCenter"}], "]"}], 
           ",", "center"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "new", ",", "new", ",", "new", ",", "new", ",", "new", ",", "new", ",",
         "old", ",", "old"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.677545707709917*^9, 3.6775457896279783`*^9}, {
   3.677545820463057*^9, 3.677546019241349*^9}, {3.677546066198923*^9, 
   3.6775460705799437`*^9}, {3.677546122214747*^9, 3.6775461326606693`*^9}, 
   3.677546185715206*^9, 3.677546219935258*^9, 3.677547439334656*^9, {
   3.6775474843097467`*^9, 3.677547566482769*^9}, {3.67754760081778*^9, 
   3.6775476148028193`*^9}, 3.677547645113679*^9, 3.677549894706705*^9, {
   3.6775501648033752`*^9, 3.677550171143784*^9}, {3.677550520931498*^9, 
   3.6775505505067997`*^9}, {3.677557396454975*^9, 3.677557408900195*^9}, {
   3.677557586697242*^9, 3.6775576215199842`*^9}, {3.677558146715934*^9, 
   3.6775581683353443`*^9}, {3.677707835093172*^9, 3.6777079438134413`*^9}, {
   3.677708045901157*^9, 3.677708052586545*^9}, {3.677708099436563*^9, 
   3.677708108601555*^9}, {3.6777081815733843`*^9, 3.677708203948041*^9}, {
   3.6777082779347563`*^9, 3.677708415051162*^9}, 3.67770846148155*^9, {
   3.6777085545419693`*^9, 3.677708564886235*^9}, {3.6777086127606773`*^9, 
   3.677708683348835*^9}, {3.677708808290159*^9, 3.6777088149452753`*^9}, {
   3.677708953319766*^9, 3.677708970087491*^9}, 3.67771226283325*^9, {
   3.677712310374093*^9, 3.677712315740275*^9}, 3.677712356470479*^9, {
   3.67771354947231*^9, 3.677713560566474*^9}, {3.677713696189328*^9, 
   3.677713714096875*^9}, {3.6777187218287983`*^9, 3.677718722776276*^9}, {
   3.677718753198139*^9, 3.677718772950129*^9}, {3.677718806322551*^9, 
   3.677718846145796*^9}, {3.677721070201399*^9, 3.677721194040238*^9}, 
   3.67772123204948*^9, {3.677722060161077*^9, 3.677722072532611*^9}, {
   3.677722370006672*^9, 3.6777223872341623`*^9}, {3.6777803254418983`*^9, 
   3.677780518834635*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"kicks", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"+", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676926045128727*^9, 3.676926055382554*^9}, {
   3.676926856106865*^9, 3.676926859653413*^9}, {3.676977428481926*^9, 
   3.6769774737741003`*^9}, 3.6769780371614637`*^9, 3.676978075458789*^9, {
   3.67754706999969*^9, 3.6775470822523727`*^9}, {3.677547881381463*^9, 
   3.677547892552577*^9}, {3.677708700915653*^9, 3.677708790472547*^9}, {
   3.677708833656745*^9, 3.67770886237923*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"scarvesStep", "=", "\[IndentingNewLine]", 
   RowBox[{"Step", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "center", ",", "east", ",", "eastEast", ",", "west", ",", "westWest", 
       ",", " ", "north", ",", "oldCenter", ",", "oldNorth", ",", "top"}], 
      "}"}], ",", "kicks", ",", "scarvesLUT", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "center", ",", "east", ",", "eastEast", ",", "west", ",", "westWest", 
       ",", " ", "north", ",", "oldCenter", ",", "oldNorth"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6769167882216167`*^9, 3.676916866765884*^9}, 
   3.6769169371943703`*^9, {3.6769171473099318`*^9, 3.6769171600896597`*^9}, {
   3.676919470022318*^9, 3.67691950932728*^9}, {3.676929560957087*^9, 
   3.676929572175973*^9}, {3.676929607227475*^9, 3.6769296091117783`*^9}, {
   3.676930169710002*^9, 3.676930213539809*^9}, {3.6772713362162247`*^9, 
   3.6772713548181467`*^9}, {3.677271395336574*^9, 3.677271429514069*^9}, 
   3.6772804180806217`*^9, {3.677437661694601*^9, 3.677437664921731*^9}, {
   3.677547097814101*^9, 3.677547175677619*^9}, {3.6775479048050213`*^9, 
   3.6775479213237257`*^9}, {3.6775572487902308`*^9, 3.677557254067422*^9}, 
   3.6775573217806807`*^9, {3.677708883189064*^9, 3.677708886314797*^9}, {
   3.6777089240288467`*^9, 3.677708937864257*^9}, {3.67770911856068*^9, 
   3.6777091616477747`*^9}}],

Cell[TextData[StyleBox["The two logical bits at each cell have the \
interpretation of \[OpenCurlyDoubleQuote]present bit\[CloseCurlyDoubleQuote] \
and \[OpenCurlyDoubleQuote]past bit\[CloseCurlyDoubleQuote].  To run \
backwards, we simply interchange present and past, and then continue running \
the dynamics.  As always, we must make copies of \
\[OpenCurlyDoubleQuote]present\[CloseCurlyDoubleQuote] to show to the \
neighbors.",
 FontColor->GrayLevel[0.5]]], "Text",
 CellChangeTimes->{{3.6776788296982737`*^9, 3.677679021210236*^9}, 
   3.677709178832589*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"reverseLUT", "=", 
   RowBox[{"LUT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"center", ",", "oldCenter"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"new", ",", "old"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"oldCenter", ",", "center"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "new", ",", "new", ",", "new", ",", "new", ",", "new", ",", "new", ",",
         "old", ",", "old"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.677677456199066*^9, 3.677677557313882*^9}, 
   3.677678009584429*^9, {3.67770921582848*^9, 3.6777092665528173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"reverseStep", " ", "=", 
   RowBox[{"Step", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"center", ",", "oldCenter"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "reverseLUT", ",", 
     RowBox[{"{", 
      RowBox[{
      "center", ",", "east", ",", "eastEast", ",", "west", ",", "westWest", 
       ",", " ", "north", ",", "oldCenter", ",", "oldNorth"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.677678028205289*^9, 3.677678083248871*^9}, 
   3.6776781228645144`*^9, 3.677678156445732*^9, 3.677709317972636*^9}],

Cell[TextData[StyleBox["We initialize the lattice with a block of randomness \
in the middle of the top line, and the \[OpenCurlyDoubleQuote]top\
\[CloseCurlyDoubleQuote] bit set everywhere on that line and nowhere else.",
 FontColor->GrayLevel[0.5]]], "Text",
 CellChangeTimes->{{3.677679128787013*^9, 3.677679184317299*^9}, {
  3.6776801484060783`*^9, 3.677680149339878*^9}, {3.677797062548834*^9, 
  3.6777970910154457`*^9}, {3.677797274699129*^9, 3.677797279550975*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"randTop", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "\[Equal]", "0"}], "&&", 
        RowBox[{"x", "\[GreaterEqual]", " ", 
         RowBox[{"3", 
          RowBox[{"X", "/", "8"}]}]}], " ", "&&", " ", 
        RowBox[{"x", "<", 
         RowBox[{"5", 
          RowBox[{"X", "/", "8"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"rand1", "=", 
         RowBox[{"RandomInteger", "[", "]"}]}], ";", " ", 
        RowBox[{"rand2", "=", 
         RowBox[{"RandomInteger", "[", "]"}]}], ";", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"rand1", ",", "6"}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"rand2", ",", "2"}], "]"}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"y", "\[Equal]", "0"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", "8"}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", "9"}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", 
       RowBox[{"Y", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"X", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6760517093867702`*^9, 3.676051722236189*^9}, 
   3.67605177139434*^9, {3.6760522667279*^9, 3.676052309637545*^9}, {
   3.676052535218696*^9, 3.676052539796286*^9}, {3.676077034382248*^9, 
   3.676077042713421*^9}, {3.676077092582697*^9, 3.67607711197139*^9}, {
   3.676077887107312*^9, 3.676077924252358*^9}, {3.6760779959655733`*^9, 
   3.6760780242374277`*^9}, {3.6766950372308683`*^9, 
   3.6766950958011227`*^9}, {3.6766951393025627`*^9, 3.676695163819672*^9}, {
   3.676725824419899*^9, 3.676725832746914*^9}, 3.676726337222197*^9, 
   3.676744578781857*^9, {3.676746832701455*^9, 3.6767468333592787`*^9}, {
   3.677073718565022*^9, 3.6770737408246737`*^9}, {3.677073790510603*^9, 
   3.6770737958945007`*^9}, {3.677546977097518*^9, 3.677547012674479*^9}, {
   3.677547840791519*^9, 3.677547844239196*^9}, 3.677683029181291*^9, {
   3.677683077059627*^9, 3.677683083942795*^9}, 3.6776831345345573`*^9, {
   3.677709536677539*^9, 3.677709774417131*^9}, {3.6777098352153378`*^9, 
   3.677709888629106*^9}, {3.6777112917721357`*^9, 3.677711403885016*^9}, {
   3.6777114375571404`*^9, 3.677711438394704*^9}, 3.677711482886951*^9, 
   3.677711807194075*^9, {3.67771197793592*^9, 3.677711982361745*^9}, 
   3.677712060248292*^9, {3.677721574516158*^9, 3.6777216010429583`*^9}, {
   3.677721698155715*^9, 3.6777217709189262`*^9}, 3.6777218505635242`*^9, 
   3.677722614603189*^9, 3.6777227108540297`*^9, 3.677724270412262*^9, 
   3.6777244663602743`*^9}],

Cell[BoxData[
 RowBox[{"WriteFields", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "center", ",", "east", ",", "eastEast", ",", "west", ",", "westWest", ",",
      "north", ",", "oldCenter", ",", " ", "oldNorth", ",", "top"}], "}"}], 
   ",", "randTop"}], "]"}]], "Input",
 CellChangeTimes->{{3.6769164507865353`*^9, 3.676916481916418*^9}, {
   3.676919349409314*^9, 3.676919358290732*^9}, {3.676929545172296*^9, 
   3.676929548320384*^9}, {3.677547053457652*^9, 3.6775470613337383`*^9}, 
   3.6775478615656853`*^9, {3.677709989424941*^9, 3.677709996779889*^9}}],

Cell[TextData[StyleBox["We dynamically watch the current value of \
\[OpenCurlyDoubleQuote]scarvesImage\[CloseCurlyDoubleQuote].  We provide a \
\[OpenCurlyDoubleQuote]quit\[CloseCurlyDoubleQuote] button that quits the run \
loop, and a \[OpenCurlyDoubleQuote]reverse\[CloseCurlyDoubleQuote] button \
that runs a single step that interchanges present and past, and then \
continues as before.  To continue after quitting, just evaluate the cell with \
the run loop again.  We don\[CloseCurlyQuote]t put instructions that directly \
affect the updating into Dynamic operations, since those interrupt normal \
execution, and may occur in the middle of an update.",
 FontColor->GrayLevel[0.5]]], "Text",
 CellChangeTimes->{{3.677679216960556*^9, 3.677679364625725*^9}, {
  3.677680212911667*^9, 3.6776802680766068`*^9}, {3.677680347684416*^9, 
  3.677680352128487*^9}, {3.67768042446132*^9, 3.677680506725731*^9}, {
  3.6776809047452917`*^9, 3.677680906021365*^9}, {3.6776810556931973`*^9, 
  3.677681058297378*^9}, {3.6776881531462803`*^9, 3.6776882400865717`*^9}, {
  3.677688276129291*^9, 3.677688282457247*^9}, {3.677710017096218*^9, 
  3.677710020470894*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", "scarvesImage", "]"}]], "Input",
 CellChangeTimes->{{3.677279640464756*^9, 3.6772796476473837`*^9}, {
  3.677280674726405*^9, 3.677280677698107*^9}, {3.6772807844493723`*^9, 
  3.677280786421266*^9}, {3.6775471856054573`*^9, 3.677547186869643*^9}, {
  3.6777100086514072`*^9, 3.677710011862911*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`scarvesImage, StandardForm],
  ImageSizeCache->{256., {30., 34.}}]], "Output",
 CellChangeTimes->{
  3.677279711386281*^9, 3.67728049761267*^9, 3.677280582822274*^9, 
   3.677280690558043*^9, 3.677280793011207*^9, 3.6774134298180323`*^9, 
   3.677437704096322*^9, 3.677503914387*^9, 3.677547283203074*^9, 
   3.67754793192944*^9, 3.677548056739993*^9, 3.677548091083282*^9, 
   3.6775485642533293`*^9, 3.6775500177025137`*^9, 3.6775501888239*^9, 
   3.677550567319417*^9, 3.6775507665204678`*^9, 3.677557145897915*^9, 
   3.67755733821767*^9, 3.677557436664959*^9, 3.677557639222929*^9, 
   3.677610169627874*^9, 3.677678392585174*^9, 3.6776798334966583`*^9, 
   3.677680976910366*^9, 3.677681016758441*^9, 3.677683153357603*^9, 
   3.6776850010188313`*^9, 3.677685161257742*^9, 3.677686806894803*^9, 
   3.6776869392751627`*^9, 3.6776877910547733`*^9, 3.677693402528697*^9, 
   3.6777029560419207`*^9, 3.6777101388314047`*^9, 3.677711475266301*^9, 
   3.677711509434814*^9, 3.6777115723997307`*^9, 3.677719109039805*^9, 
   3.677721355765182*^9, 3.677721478236286*^9, 3.677721877997951*^9, 
   3.677721910739211*^9, 3.677722826033041*^9, {3.677723019149094*^9, 
   3.677723047486743*^9}, 3.677723102977428*^9, 3.677723177000811*^9, 
   3.677723220831039*^9, 3.677723298283297*^9, 3.677723338509618*^9, 
   3.6777241292296352`*^9, 3.677724181348144*^9, 3.67772423390947*^9, 
   3.6777243679231987`*^9, 3.677724472984416*^9, {3.677724529189179*^9, 
   3.6777245506777563`*^9}, 3.677724612763226*^9, 3.677724989282278*^9, 
   3.677776077965602*^9, 3.677776195613263*^9, 3.677780248650112*^9, 
   3.677780641064011*^9, 3.677781106016782*^9, 3.6777817693371887`*^9, {
   3.677781831291552*^9, 3.677781858793133*^9}, 3.6777961719185667`*^9, 
   3.677796214926058*^9, 3.6779442085275917`*^9, 3.69172286270779*^9, 
   3.7066719327453957`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"run", "=", "True"}], ";", " ", 
  RowBox[{"reverse", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Reverse\>\"", ",", 
        RowBox[{"reverse", "=", "True"}]}], "]"}], ",", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Quit\>\"", ",", 
        RowBox[{"run", "=", "False"}]}], "]"}]}], "}"}], "]"}], " ", "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{"run", ",", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{"reverse", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"UpdateLattice", "[", "reverseStep", "]"}], ";", " ", 
         RowBox[{"reverse", "=", "False"}]}], ")"}], ",", 
       RowBox[{"UpdateLattice", "[", 
        RowBox[{"scarvesStep", ",", "2"}], "]"}]}], "]"}], ";", 
     RowBox[{"scarvesImage", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"ReadFields", "[", 
        RowBox[{"{", 
         RowBox[{"center", ",", "oldCenter"}], "}"}], "]"}], "]"}]}]}], 
    ")"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.67727987048532*^9, 3.677279898517233*^9}, {
   3.677279929075202*^9, 3.677279936047266*^9}, {3.677280078811948*^9, 
   3.677280146205212*^9}, {3.6772801811680803`*^9, 3.677280184192918*^9}, {
   3.6772802414180107`*^9, 3.6772802581152897`*^9}, 3.677280467034134*^9, {
   3.677280557634807*^9, 3.677280565443047*^9}, {3.677280684388764*^9, 
   3.6772806852023907`*^9}, {3.677280800864909*^9, 3.677280802892879*^9}, {
   3.677437674761669*^9, 3.6774376844198837`*^9}, {3.6775471931276197`*^9, 
   3.677547204644779*^9}, {3.67754962047543*^9, 3.677549621559845*^9}, 
   3.677549745023522*^9, {3.6775572669239073`*^9, 3.6775572855092297`*^9}, {
   3.6776782205213413`*^9, 3.677678252259009*^9}, {3.677678315270185*^9, 
   3.677678366563566*^9}, {3.6776797842038193`*^9, 3.677679801029739*^9}, {
   3.6776809172332706`*^9, 3.677680939079981*^9}, {3.677680992561483*^9, 
   3.677680993933791*^9}, {3.6776873427935247`*^9, 3.677687479986981*^9}, 
   3.677687523082087*^9, {3.677687573990635*^9, 3.677687706825808*^9}, {
   3.677710061408354*^9, 3.677710096385717*^9}, {3.677723520939349*^9, 
   3.677723521885482*^9}, 3.67772518673944*^9, 3.677725237333102*^9}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   Row[{
     Button["Reverse", $CellContext`reverse = True], 
     Button["Quit", $CellContext`run = False]}], StandardForm],
  ImageSizeCache->{140., {8.3, 17.7}}]], "Output",
 CellChangeTimes->{
  3.677280147671335*^9, 3.6772801935735283`*^9, {3.677280272803691*^9, 
   3.6772802861505833`*^9}, 3.677280332636683*^9, 3.677280497780987*^9, 
   3.677280582977255*^9, 3.677280696586977*^9, {3.6772808084112186`*^9, 
   3.677280827126965*^9}, 3.67741342991252*^9, 3.677437704165244*^9, 
   3.67750391449229*^9, 3.677547283292728*^9, 3.677548056835333*^9, 
   3.6775480911931257`*^9, 3.67754857018981*^9, 3.6775493612770853`*^9, {
   3.677549603590579*^9, 3.67754962855579*^9}, 3.677549729472067*^9, 
   3.677550017767873*^9, 3.677550188907782*^9, 3.677550567406686*^9, 
   3.6775507666000433`*^9, 3.677557146029106*^9, 3.677557338335229*^9, 
   3.677557436794908*^9, 3.677557639300861*^9, 3.677610169718442*^9, 
   3.6776783926640778`*^9, 3.6776798336157503`*^9, 3.677680976988015*^9, 
   3.6776810168458433`*^9, 3.677683059291149*^9, 3.6776831144384336`*^9, 
   3.6776831534574547`*^9, 3.677685001107869*^9, 3.677685161348632*^9, 
   3.677686806986102*^9, 3.677686939384831*^9, {3.677687772123865*^9, 
   3.677687791147566*^9}, 3.677688097306509*^9, 3.6776934026159897`*^9, 
   3.6776934800040503`*^9, 3.677702956143737*^9, 3.677710138945513*^9, 
   3.677711475375801*^9, 3.6777115095351048`*^9, 3.677711572477973*^9, 
   3.677719109157462*^9, 3.677721355852202*^9, 3.677721478340045*^9, 
   3.67772187812228*^9, 3.6777219108391867`*^9, 3.67772282616395*^9, {
   3.677723019258847*^9, 3.677723047625924*^9}, 3.6777231030635653`*^9, 
   3.677723177093326*^9, 3.6777232209268703`*^9, 3.677723298377974*^9, 
   3.67772333862964*^9, 3.67772352955125*^9, 3.677724129328905*^9, 
   3.677724181455687*^9, 3.677724234035833*^9, 3.677724368090971*^9, 
   3.677724473109582*^9, {3.6777245293029613`*^9, 3.6777245507969913`*^9}, 
   3.6777246128804417`*^9, 3.677724989393032*^9, 3.677725189089559*^9, 
   3.67772524007983*^9, 3.67772577495702*^9, 3.677776078050558*^9, 
   3.677776195693565*^9, 3.677780248743222*^9, 3.677780573755247*^9, 
   3.6777806411622047`*^9, 3.677781106111971*^9, 3.677781769431505*^9, {
   3.677781831396248*^9, 3.677781858884982*^9}, 3.677796172040635*^9, 
   3.677796215017091*^9, 3.67794420863538*^9, 3.69172286282928*^9, 
   3.7066719328503428`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"5", "/", 
  RowBox[{
   RowBox[{"Timing", "[", 
    RowBox[{"UpdateLattice", "[", 
     RowBox[{"scarvesStep", ",", "5"}], "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.677503973995226*^9, 3.6775039767945557`*^9}, {
  3.6775040181985598`*^9, 3.677504041556446*^9}, {3.677547234010693*^9, 
  3.6775472369218273`*^9}, {3.677721420832999*^9, 3.677721444414897*^9}, {
  3.677944194599842*^9, 3.677944204707062*^9}}],

Cell[BoxData["90.84962569954212`"], "Output",
 CellChangeTimes->{
  3.677504077319189*^9, 3.677547343268629*^9, 3.677548340358734*^9, 
   3.677549342236079*^9, 3.6775501364762573`*^9, 3.677550290019725*^9, 
   3.677550594770336*^9, 3.677550800371138*^9, 3.677557174606056*^9, 
   3.677557473478694*^9, 3.677558010949223*^9, {3.677610319572451*^9, 
   3.677610359344967*^9}, 3.677678553381023*^9, 3.677679886829805*^9, 
   3.677681000674775*^9, 3.677681059970235*^9, 3.677683179514887*^9, 
   3.677685030063826*^9, 3.67768519510336*^9, 3.677686839764985*^9, 
   3.677687001937055*^9, 3.677687846014214*^9, {3.677693434178693*^9, 
   3.677693471802022*^9}, 3.677702986453857*^9, 3.677710192613905*^9, 
   3.677711535089884*^9, 3.677711591595831*^9, 3.6777213990842943`*^9, {
   3.6777214351546593`*^9, 3.677721456017478*^9}, 3.677721508648741*^9, 
   3.677721933398797*^9, 3.677723029971362*^9, 3.6777230873148537`*^9, 
   3.677723131263452*^9, 3.677723196670664*^9, 3.677723296918118*^9, 
   3.677723328585003*^9, 3.677723516219391*^9, 3.677724152936378*^9, 
   3.677724214405106*^9, 3.677724245383914*^9, 3.6777243871096992`*^9, {
   3.6777245133843727`*^9, 3.677724538134261*^9}, 3.677724583795767*^9, 
   3.677724971648741*^9, {3.677725087174582*^9, 3.677725113057043*^9}, 
   3.6777761827688713`*^9, 3.677776368242486*^9, 3.677780260940568*^9, 
   3.6777806644778433`*^9, 3.677781137377273*^9, 3.677781778117585*^9, {
   3.677781840296525*^9, 3.677781867848674*^9}, 3.6777962111439323`*^9, 
   3.677796252733243*^9, {3.6779442532213163`*^9, 3.67794426968438*^9}, 
   3.691722946834404*^9, 3.706671993524169*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["To animate, save a ",
  FontColor->GrayLevel[0.5]],
 StyleBox["Table",
  FontWeight->"Bold",
  FontColor->GrayLevel[0.5]],
 StyleBox[" of images to ",
  FontColor->GrayLevel[0.5]],
 StyleBox["imageList ",
  FontWeight->"Bold",
  FontColor->GrayLevel[0.5]],
 StyleBox["and use ",
  FontColor->GrayLevel[0.5]],
 StyleBox["ListAnimate[imageList]",
  FontWeight->"Bold",
  FontColor->GrayLevel[0.5]],
 StyleBox[".  To export a movie, use ",
  FontColor->GrayLevel[0.5]],
 StyleBox["Export[\[OpenCurlyDoubleQuote]directory/name.mov\
\[CloseCurlyDoubleQuote],imageList]",
  FontWeight->"Bold",
  FontColor->GrayLevel[0.5]]
}], "Text",
 CellChangeTimes->{{3.67770333925939*^9, 3.677703369205873*^9}, {
  3.677703403048716*^9, 3.67770342009582*^9}, {3.6777034911035633`*^9, 
  3.677703507720806*^9}}]
}, Open  ]]
},
WindowSize->{1007, 723},
WindowMargins->{{257, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 260, 5, 99, "Section"],
Cell[843, 29, 1458, 20, 125, "Text"],
Cell[2304, 51, 1648, 29, 32, "Input"],
Cell[3955, 82, 2965, 57, 96, "Input"],
Cell[6923, 141, 1215, 34, 32, "Input"],
Cell[8141, 177, 1437, 26, 75, "Input"],
Cell[9581, 205, 565, 9, 49, "Text"],
Cell[10149, 216, 699, 19, 54, "Input"],
Cell[10851, 237, 721, 19, 54, "Input"],
Cell[11575, 258, 474, 6, 30, "Text"],
Cell[12052, 266, 2988, 63, 75, "Input"],
Cell[15043, 331, 568, 11, 32, "Input"],
Cell[15614, 344, 1161, 16, 87, "Text"],
Cell[CellGroupData[{
Cell[16800, 364, 338, 5, 32, "Input"],
Cell[17141, 371, 1882, 28, 79, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19060, 404, 2362, 49, 117, "Input"],
Cell[21425, 455, 2403, 37, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23865, 497, 478, 10, 32, "Input"],
Cell[24346, 509, 1614, 23, 32, "Output"]
}, Open  ]],
Cell[25975, 535, 819, 25, 49, "Text"]
}, Open  ]]
}
]
*)

